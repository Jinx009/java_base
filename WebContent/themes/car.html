<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Parking</title>
<meta name="viewport"
	content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<link rel="stylesheet" href="/themes/dist/css/bootstrap.min.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
<link rel="stylesheet" href="/themes/awe/dist/css/AdminLTE.min.css">
<link rel="stylesheet"
	href="/themes/awe/dist/css/skins/_all-skins.min.css">
<link rel="stylesheet" href="/themes/css/home/main.css?_v=1">
<link rel="stylesheet" href="/themes/css/home/pro/view.css?_v=1">
<!--[if lt IE 9]>
    	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<body>
	<!-- Site wrapper -->
	<div class="wrapper" style="z-index: 999;">
		<img alt="" src="/themes/img/logo2.png" style="height: 80px;"> <img
			alt="" src="/themes/img/logo3.jpeg" style="height: 60px;">
		<!-- 路径导航 -->
		<div class="content-wrapper"
			style="background-color: white; margin-left: 5%;">
			<section class="content-header" style="height: 50px;">
				<h1></h1>
				<ol class="breadcrumb">
					<li><a href="#"><i class="fa fa-dashboard"></i> 停车示意图 </a></li>
				</ol>
			</section>
			<!-- 主内容 -->
			<section class="content">
				<div class="location"></div>
			</section>
		</div>
	</div>
	<!-- 底部导航 -->
	<footer class="main-footer">
		<div class="pull-right hidden-xs">
			<b>Version</b> 1.0.0
		</div>
		<strong>Copyright &copy; 2014-2026 <a
			href="http://www.zhanway.com" target="_blank">上海展为智能技术股份有限公司</a>.
		</strong> All rights reserved.
	</footer>
	<div class="control-sidebar-bg"></div>
	<script src="/themes/awe/plugins/jQuery/jquery-2.2.3.min.js"></script>
	<!-- <script src="/themes/js/jquery-1.7.2.min.js"></script>  -->
	<script src="/themes/dist/js/bootstrap.min.js"></script>
	<script src="/themes/awe/plugins/slimScroll/jquery.slimscroll.min.js"></script>
	<script src="/themes/awe/plugins/fastclick/fastclick.js"></script>
	<script src="/themes/awe/dist/js/app.min.js"></script>
	<script src="/themes/js/vue.min.js"></script>
	<script src="/themes/js/common.js"></script>
	<script src="/themes/layer/layer.js"></script>
	<!--[if lt IE 9]>
  <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
<![endif]-->
	<script src="/themes/md5.js?version=1.2"></script>
	<script src="/themes/js/home/pro/car_.js?version=1.88"></script>
	<script>
		var _md_str = {
			appEUI : '000000000000006c',
			User_Sec : 'a7da4728e374343d37021e4be5593311',
			time_s : '1504774928'
		};
		var _md = hex_md5(_md_str.time_s + _md_str.appEUI + _md_str.User_Sec);
		console.log(_md);
		var str = 'ws://www.guodongiot.com:92/webs?appEUI=' + _md_str.appEUI
				+ '&token=' + _md + '&time_s=' + _md_str.time_s;
		var ws = new WebSocket(str);
		// 打开Socket
		ws.onopen = function(event) {

			// 发送一个初始化消息
			ws.send('I am the client and I\'m listening!');

			// 监听消息
			ws.onmessage = function(event) {
				console
						.log('Client received a message', JSON
								.parse(event.data));
				var _data = JSON.parse(event.data).data;
				var _mac = JSON.parse(event.data).devEUI;
				sendData(_data, _mac);
			};

			// 监听Socket的关闭
			ws.onclose = function(event) {
				console.log('Client notified socket has closed', event);
			};

			// 关闭Socket....
			//socket.close()
		};
		function hexToString(str) {
			var val = "";
			var arr = str.split(",");
			for (var i = 0; i < arr.length; i++) {
				val += arr[i].fromCharCode(i);
			}
			return val;
		}
		function sendData(_data, _mac) {
			var _arr = _data.split('');
			console.log(_arr + '----' + _arr[_arr.length - 1] + '--------');
			if (_arr[6] == '3' && _arr[7] == '0') {
				_addr = '10001';
				if (_mac == '0000000000004f96') {
					_addr = '10002';
				}
				var _data = [ {
					"bluetooth" : "2222222",
					"available" : _arr[_arr.length - 1],
					"id" : 397,
					"addr" : _addr
				} ];
				run(_data);
				console.log(_arr + '</br>' + _data);
			}
		}
	</script>
</body>
</html>