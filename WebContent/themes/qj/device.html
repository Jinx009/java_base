<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>倾角设备管理</title>
<link
	href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
	rel="stylesheet">
</head>
<body>
	<nav class="navbar navbar-default">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
					data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"
					aria-expanded="false">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" target="_blank"
					href="http://www.zhanway.com"><img height="50px;"
					style="margin-top: -15px;" src="img/logo.png"></a>
			</div>
			<div class="collapse navbar-collapse"
				id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li><a href="show.html">地理位置</a></li>
					<li class="active"><a href="device.html">设备管理</a></li>
					<li><a href="logs.html">报警管理</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><a target="_blank" href="http://www.zhanway.com">走进展为</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="row" style="width: 98%; margin-left: 1%;">
		<div class="col-md-12" id="data">
			<div class="panel panel-default" style="border-color: white;">
				<div class="panel-heading">基本信息</div>
				<div class="panel-body">
				<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
					  <div class="panel panel-default" style="margin-bottom: 10px; width: 96%; margin-left: 2%;"
						v-for="item in datas">
					    <div class="panel-heading" role="tab" v-bind:id="'heading'+item.id">
					      <h4 class="panel-title">
					        <a role="button" data-toggle="collapse" data-parent="#accordion" v-bind:href="'#collapse'+item.id"  aria-expanded="false"
					        v-text="item.snValue" v-bind:aria-controls="'collapse'+item.id"> </a>
					      </h4>
					    </div>
					    <div v-bind:id="'collapse'+item.id" class="panel-collapse collapse in" role="tabpanel"  v-bind:aria-labelledby="'heading'+item.id">
					      <div class="panel-body">
					        	<table class="table table-bordered">
							<tbody>
								<tr>
									<th>编号</th>
									<td v-text="item.id"></td>
									<th>SN</th>
									<td v-text="item.snValue"></td>
									<th>x值</th>
									<td v-text="item.baseX"></td>
									<th>y值</th>
									<td v-text="item.baseY"></td>
								</tr>
								<tr>
									<th>x偏移值</th>
									<td v-text="item.xvalue"></td>
									<th>y偏移值</th>
									<td v-text="item.yvalue"></td>
									<th>x轴报警</th>
									<td><font v-if="0!==item.xtype" style="color: red;">是</font><font
										v-if="0===item.xtype">否</font></td>
									<th>y轴报警</th>
									<td><font v-if="0!==item.ytype" style="color: red;">是</font><font
										v-if="0===item.ytype">否</font></td>
								</tr>
									<tr>
									<th>x加速度</th>
									<td v-text="item.baseAcceX"></td>
									<th>x加速度报警</th>
									<td><font v-if="0!==item.acceXType" style="color: red;">是</font><font
										v-if="0===item.acceXType">否</font></td>
									<th>y加速度</th>
									<td v-text="item.acceYType"></td>
									<th>y加速度报警</th>
									<td><font v-if="0!==item.acceYType" style="color: red;">是</font><font
										v-if="0===item.acceYType">否</font></td>
								</tr>
								<tr>
									<th>z加速度</th>
									<td v-text="item.acceZType"></td>
									<th>z加速度报警</th>
									<td><font v-if="0!==item.acceZType" style="color: red;">是</font><font
										v-if="0===item.acceZType">否</font></td>
									<th>推送手机号</th>
									<td><input type="text" v-bind:id="'_m'+item.snValue"
										class="form-control" v-bind:value="item.mobilePhone">
									</td>
									<th>位置</th>
									<td><input type="text" v-bind:id="'_a'+item.snValue"
										class="form-control" v-bind:value="item.address"></td>
								</tr>
								<tr>
									<th>经度</th>
									<td><input type="text" v-bind:id="'_j'+item.snValue"
										class="form-control" v-bind:value="item.longitude"></td>
									<th>纬度</th>
									<td><input type="text" v-bind:id="'_w'+item.snValue"
										class="form-control" v-bind:value="item.latitude"></td>
									<th>发送短信</th>
									<td><font v-if="1===item.noticeType" style="color: red;">是</font><font
										v-if="0===item.noticeType">否</font></td>
									<th>更新时间</th><td v-text="item.createTime"></td>
								</tr>
								<tr>
										<th>电压</th>
										<td v-text="item.voltage"></td>
										<th>操作</th>
										<td colspan="5"><span class="label label-info"
										v-bind:idx="item.snValue" onclick="_save(this)">保存</span>&nbsp;&nbsp;
										<span v-if="1===item.noticeType" class="label label-danger"
										v-bind:idx="item.snValue" onclick="_cacleMsg(this)">取消短信</span>
										<span v-if="0===item.noticeType" class="label label-success"
										v-bind:idx="item.snValue" onclick="_saveMsg(this)">短信推送</span>&nbsp;&nbsp;
										<span v-if="0===item.doneType" class="label label-default"
										v-bind:idx="item.snValue" onclick="_done(this)">处理完毕</span></td>
								</tr>
							</tbody>
						</table>
					    </div>
					  </div>
					  </div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer class="main-footer"
		style="text-align: center; width: 100%;  bottom: 15px;">
		<strong>Copyright &copy; <a href="http://www.zhanway.com"
			target="_blank">上海展为智能技术股份有限公司</a>.
		</strong> All rights reserved.
	</footer>
	<div class="control-sidebar-bg"></div>
</body>
<script src="https://cdn.bootcss.com/jquery/1.12.0/jquery.min.js"></script>
<script
	src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/vue/2.4.4/vue.min.js"></script>
<script src="/themes/layer/layer.js"></script>
<script src="js/base.js"></script>
<script type="text/javascript">
	$(function() {
		_getData();
	})
	function _getData() {
		$.ajax({
			url : '/home/cloud/qj/list',
			dataType : 'json',
			type : 'get',
			success : function(res) {
				for(var i in res.data){
					res.data[i].createTime = jsDateTime(res.data[i].createTime);
				}
				new Vue({
					el : '#data',
					data : {
						datas : res.data
					}
				})
			}
		})
	}
	function _save(_e) {
		var _id = $(_e).attr('idx');
		$.ajax({
			url : '/home/cloud/qj/update',
			data : 'sn=' + _id + '&address=' + $('#_a' + _id).val()
					+ '&mobilePhone=' + $('#_m' + _id).val() + '&longitude='
					+ $('#_j' + _id).val() + '&latitude='
					+ $('#_w' + _id).val(),
			dataType : 'json',
			type : 'post',
			success : function(res) {
				if ('200' == res.code) {
					layer.alert('操作成功！', function() {
						location.reload();
					})
				} else {
					layer.alert(res.msg);
				}
			}
		})
	}
	function _done(_e) {
		var _id = $(_e).attr('idx');
		$.ajax({
			url : '/home/cloud/qj/update?sn=' + _id + '&doneType=1',
			dataType : 'json',
			type : 'get',
			success : function(res) {
				if ('200' == res.code) {
					layer.alert('操作成功！', function() {
						location.reload();
					})
				} else {
					layer.alert(res.msg);
				}
			}
		})
	}
	function _cacleMsg(_e) {
		var _id = $(_e).attr('idx');
		$.ajax({
			url : '/home/cloud/qj/update?sn=' + _id + '&noticeType=0',
			dataType : 'json',
			type : 'get',
			success : function(res) {
				if ('200' == res.code) {
					layer.alert('操作成功！', function() {
						location.reload();
					})
				} else {
					layer.alert(res.msg);
				}
			}
		})
	}
	function _saveMsg(_e) {
		var _id = $(_e).attr('idx');
		$.ajax({
			url : '/home/cloud/qj/update?sn=' + _id + '&noticeType=1',
			dataType : 'json',
			type : 'get',
			success : function(res) {
				if ('200' == res.code) {
					layer.alert('操作成功！', function() {
						location.reload();
					})
				} else {
					layer.alert(res.msg);
				}
			}
		})
	}
</script>
</html>