{"version":3,"sources":["iot_1.js"],"names":[],"mappings":"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","file":"iot_1-compiled.js","sourcesContent":["$(function(){\n\t_getLight();\n\tvar _pm = getSessionStorage('_pm');\n\tif(_pm!=null&&_pm!=''){\n\t\t$('#r').val(_pm);\n\t}\n\t_hasTouch();\n})\nvar $sliderTrack = $('#sliderTrack'), $sliderHandler = $('#sliderHandler'), $sliderValue = $('#sliderValue');\nfunction _getData(){\n\t$.ajax({\n\t\turl:'/interface/product/set/light',\n\t\ttype:'get',\n\t\tdataType:'json',\n\t\tsuccess:function(res){\n\t\t\tif(res!=null&&'success'==res.data){\n\t\t\t\tlayer.open({\n\t\t\t\t    type: 2\n\t\t\t\t    ,content: '等待数据上报...'\n\t\t\t\t });\n\t\t\t\t$('#pmBtn').html('查询').attr('onclick','_setPM2_5();').removeClass('weui-btn_disabled');\n\t\t\t\tsetTimeout('_getLight();',30000);\n\t\t\t}else{\n\t\t\t\tvar _data = JSON.parse(res.data);\n\t\t\t    layer.open({\n\t\t\t\t    content: _data.errorMsg\n\t\t\t\t    ,btn: '好'\n\t\t\t\t});\n\t\t\t    $('#status').val('OFFLINE');\n\t\t\t    $('#l').val('0%');\n\t\t\t    $('#status_1').val('OFFLINE');\n\t\t\t\t$sliderTrack.css('width','0%');\n\t\t\t\t$sliderHandler.css('left','0%');\n\t\t\t\t$('#lightBtn').html('当前设备关闭').attr('onclick','').addClass('weui-btn_disabled');\n\t\t\t\t$('#pmBtn').html('当前设备关闭').attr('onclick','').addClass('weui-btn_disabled');\n\t\t\t}\n\t\t}\n\t})\n}\nfunction _setV(_t){\n\t$('#v').val('30V');\n    $('#a').val(210*_t+'mA');\n    $('#w').val(10.5*_t+'W');\n}\nfunction _getLight(){\n\t$.ajax({\n\t\turl:'/interface/product/get',\n\t\ttype:'get',\n\t\tdataType:'json',\n\t\tsuccess:function(res){\n\t\t\tlayer.closeAll();\n\t\t\tvar _data = JSON.parse(res.data);\n\t\t\tvar _arr = _data.rawData.split('');\n\t\t\tvar _date = _data.eventTime;\n\t\t\tvar date1 = new Date( new Date(Date.parse(_date.replace(/-/g,\"/\"))).getTime());\n\t\t\tvar date2 = new Date();\n\t\t\tvar s1 = date1.getTime(),s2 = date2.getTime();\n\t\t\tvar total = (s2 - s1)/1000;\n\t\t\tif(_arr.length>14&&total<30){\n\t\t\t\tvar _v = parseInt(_arr[3]+_arr[4]+_arr[5]+_arr[6]);\n\t\t\t\tvar _a = parseInt(_arr[10]+_arr[11]+_arr[12]+_arr[13]);\n\t\t\t\tvar _w = parseInt(_arr[17]+_arr[18]+_arr[19]+_arr[20]);\n\t\t\t\tvar _l = parseInt(_arr[23]+_arr[24]+_arr[25]);\n\t\t\t\t$('#status').val('ONLINE');\n\t\t\t    $('#status_1').val('ONLINE');\n\t\t\t    $('#v').val(_v+'V');\n\t\t\t    $('#a').val(_a+'A');\n\t\t\t    $('#w').val(_w+'W');\n\t\t\t    $('#l').val(_l+'%');\n\t\t\t    if(_l>0){\n\t\t\t    \t_setV(_l/100);\n\t\t\t    }\n\t\t\t\t$sliderTrack.css('width',_l+'%');\n\t\t\t\t$sliderHandler.css('left',_l+'%');\n\t\t\t\t$('#lightBtn').html('设置亮度'+_l+'%').attr('onclick','_setData();').removeClass('weui-btn_disabled');\n\t\t\t\t_hasTouch();\n\t\t\t}else{\n\t\t\t\t_getData();\n\t\t\t}\n\t\t}\n\t})\n}\nvar _setStatus ='0001';\nfunction _setData(){\n\tif(_pmStatus){\n\t\t$.ajax({\n\t\t\turl:'/interface/product/set/light',\n\t\t\ttype:'get',\n\t\t\tdataType:'json',\n\t\t\tsuccess:function(res){\n\t\t\t\tif(res!=null&&'success'==res.data){\n\t\t\t\t\t_pmStatus = false;\n\t\t\t\t\tlayer.open({\n\t\t\t\t\t    type: 2\n\t\t\t\t\t    ,content: '状态切换中...'\n\t\t\t\t\t });\n\t\t\t\t\tsetTimeout('_getLight();',10000);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}else{\n\t\t$.ajax({\n\t\t\turl:'/interface/product/set?status='+_setStatus,\n\t\t\ttype:'get',\n\t\t\tdataType:'json',\n\t\t\tsuccess:function(res){\n\t\t\t\tif(res!=null&&'success'==res.data){\n\t\t\t\t\tif(_setStatus=='000A'){\n\t\t\t\t\t\t $('#l').val('100%');\n\t\t\t\t\t\t _setV(1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(_setStatus>0){\n\t\t\t\t\t\t\t_setV(_setStatus/10);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$('#l').val(parseInt(_setStatus)*10+'%');\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tvar _data = JSON.parse(res.data);\n\t\t\t\t    layer.open({\n\t\t\t\t\t    content: _data.errorMsg\n\t\t\t\t\t    ,btn: '好'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n}\nfunction _hasTouch(){\n\tvar totalLen = $('#sliderInner').width(), startLeft = 0, startX = 0;\n\t$sliderHandler.on(\n\t\t\t\t\t'touchstart',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\tstartLeft = parseInt($sliderHandler.css('left'))* totalLen / 100;\n\t\t\t\t\t\tstartX = e.changedTouches[0].clientX;\n\t\t\t\t\t}).on(\n\t\t\t\t\t'touchmove',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\tvar dist = startLeft+ e.changedTouches[0].clientX - startX, percent;\n\t\t\t\t\t\tdist = dist < 0 ? 0 : dist > totalLen ? totalLen : dist;\n\t\t\t\t\t\tpercent = parseInt(dist / totalLen * 100);\n\t\t\t\t\t\t$sliderTrack.css('width', percent + '%');\n\t\t\t\t\t\t$sliderHandler.css('left', percent + '%');\n\t\t\t\t\t\t_setStatus = parseInt(percent/10);\n\t\t\t\t\t\tif(_setStatus==0){\n\t\t\t\t\t\t\t$('#lightBtn').html('关灯').attr('onclick','_setData();').removeClass('weui-btn_disabled');\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t$('#lightBtn').html('设置亮度'+_setStatus*10+'%').attr('onclick','_setData();').removeClass('weui-btn_disabled');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_setStatus = '000'+_setStatus;\n\t\t\t\t\t\tif(_setStatus==10){\n\t\t\t\t\t\t\t_setStatus = '000A';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$sliderValue.text(percent);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t});\n}\nfunction _noTouch(){\n\tvar totalLen = $('#sliderInner').width(), startLeft = 0, startX = 0;\n\t$sliderHandler.on(\n\t\t\t\t\t'touchstart',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\tconsole.log('_noTouch');\n\t\t\t\t\t}).on(\n\t\t\t\t\t'touchmove',\n\t\t\t\t\tfunction(e) {});\n}\nvar _pmStatus = false;\nfunction _setPM2_5(){\n\t$('#pmBtn').hide();\n\t$('#pm_Btn').show();\n\t$.ajax({\n\t\turl:'/interface/product//set/PM2_5',\n\t\ttype:'get',\n\t\tdataType:'json',\n\t\tsuccess:function(res){\n\t\t\tif(res!=null&&'success'==res.data){\n\t\t\t\t_pmStatus = true;\n\t\t\t\tsetTimeout('_getPMData();',30000);\n\t\t\t}else{\n\t\t\t\tvar _data = '设备不在线！';\n\t\t\t    layer.open({\n\t\t\t\t    content: _data\n\t\t\t\t    ,btn: '好'\n\t\t\t\t});\n\t\t\t    $('#pmBtn').show();\n\t\t\t\t$('#pm_Btn').hide();\n\t\t\t}\n\t\t}\n\t})\n}\nfunction _getPMData(){\n\t$.ajax({\n\t\turl:'/interface/product/get',\n\t\ttype:'get',\n\t\tdataType:'json',\n\t\tsuccess:function(res){\n\t\t\tlayer.closeAll();\n\t\t\t$('#pmBtn').show();\n\t\t\t$('#pm_Btn').hide();\n\t\t\tvar _data = JSON.parse(res.data).rawData;\n\t\t\t$('#r').val(_data);\n\t\t\tsetSessionStorage('_pm',_data);\n\t\t}\n\t})\n}\n\nfunction getSessionStorage(_key){\n\tif(window.sessionStorage){     \n\t\treturn window.sessionStorage.getItem(_key);\n\t}\n}\nfunction setSessionStorage(_key,_value){\n\tif(window.sessionStorage){     \n\t\tvar _r = window.sessionStorage.setItem(_key,_value);\n\t\tif(_r!=null&&_r!=''&&_r!=undefined){\n\t\t\treturn _r;\n\t\t}else{\n\t\t\treturn '';\n\t\t}\n\t}else{ \n\t\treturn '';\n\t}\n}"]}