    <#include "gnss_header.html">
    <div class="page-content-wrapper">
        <div class="page-content">
            <div class="page-bar">
                <ul class="page-breadcrumb">
                    <li>
                        <i class="fa fa-home"></i>
                        <a href="">辅助管理</a>
                        <i class="fa fa-angle-right"></i>
                    </li>
                </ul>
            </div>
            		<div class="row" style="margin-top: 15px;">
					<div class="col-md-6">
						<form id="form" action="/d/gnssrtkfirmware/uploadFile" 
							enctype="multipart/form-data"  method="post" style="display: none;" >
			                    <input type="file"  id="file" name="file" >
			            </form>
						<form class="form-horizontal" role="form">
								<div class="form-group">
									<label for="inputEmail1" class="col-md-2 control-label">固件名称</label>
									<div class="col-md-6">
										<input type="text" class="form-control" id="name" placeholder="固件名称">
									</div>
								</div>
								<div class="form-group">
									<label for="inputPassword12" class="col-md-2 control-label">版本号</label>
									<div class="col-md-6">
										<input type="text" class="form-control" id="versionNumber" >
									</div>
								</div>
								 <div class="form-group">
								 	<label for="inputPassword12" class="col-md-2 control-label">固件上传</label>
								 	<div class="col-md-6">
					                	<input type="text" id="fileShow"  onclick="_showUpload();" placeholder="点击上传" readonly="readonly" class="form-control">
					                 </div>
				                 </div>
								<div class="form-group">
									<div class="col-md-offset-2 col-md-10">
										<button type="button" onclick="save()" class="btn blue">保存</button>
									</div>
								</div>
							</form>
					</div>
				</div>
            <div class="row" style="margin-top: 15px;">
                <div class="col-md-12 col-sm-12">
                    <div class="portlet light bordered">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="icon-share font-blue-steel"></i>
                                <span class="caption-subject font-blue-steel ">固件管理</span>
                            </div>
                        </div>
                        <div class="portlet-body">
                            <div class="slimScrollDiv"
                                 style="position: relative; width: auto;"  id="data" >
                            <div class="table-scrollable">
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                    <tr>
                                        <th scope="col">id</th>
										<th scope="col">固件名称</th>
										<th scope="col">版本号</th>
										<th scope="col">下载</th>
										<th scope="col">创建时间</th>
										<th scope="col">操作</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="item in datas.list">
										<td v-text="item.id"></td>
										<td v-text="item.name"></td>
										<td v-text="item.versionNumber"></td>
										<td>
											<a v-bind:href="item.url" target="_blank" v-text="'点击下载'"></a>
										</td>
										<td v-text="item.createTime"></td>
										<td>
											<a v-text="'删除'" v-bind:id="item.id" onclick="del(this)"></a>
										</td>
									</tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="row">
                                <div class="col-md-9 col-sm-12"></div>
                                <div class="col-md-3 col-sm-12">
                                    <div class="dataTables_paginate paging_simple_numbers"
                                         id="sample_editable_1_paginate">
                                        <ul class="pagination">
                                            <li class="paginate_button previous "
                                                aria-controls="sample_editable_1" tabindex="0"
                                                id="sample_editable_1_previous">
                                                <a href="#" onclick="_sub()">
                                                    <i class="fa fa-angle-left"></i>
                                                </a>
                                            </li>
                                            <li class="paginate_button active" aria-controls="sample_editable_1"
                                                tabindex="0">
                                                   <a href="#" v-text="'当前第'+datas.page.currentPage+'页;共'+datas.page.pages+'页'" ></a>
                                            </li>
                                            <li class="paginate_button next "
                                                aria-controls="sample_editable_1" tabindex="0"
                                                id="sample_editable_1_next">
                                                <a href="#" onclick="_add()">
                                                    <i class="fa fa-angle-right"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
 <#include "gnss_footer.html">
 <script src="https://cdn.bootcss.com/jquery.form/4.2.2/jquery.form.min.js"></script>
 <script src="/themes/js/ajaxUpload.js?version=1.54"></script>
<script>
    $(function () {
        _setClass();
        _getData();
    });
    function del(_e){
    	var id = $(_e).attr('id');
    	$.ajax({
    		url:'/d/gnssrtkfirmware/del?id='+id,
    		dataType:'json',
    		success:function(res){
    			if('200'==res.code){
    				layer.alert('操作成功',function(){
    					p=1;max=1;
    					_getData();
    				})
    			}
    		}
    	})
    }
    var mac = '';
    var p = 1;
    var max = 1;
    var _d = '';
    function _getData(){
    	$.ajax({
    		url:'/d/gnssrtkfirmware/list?p='+p,
    		type:'get',
    		dataType:'json',
    		success:function(res){
    			max = res.data.page.pages;
    			for ( var i in res.data.list) {
					res.data.list[i].createTime = toDateTime(res.data.list[i].createTime);
					res.data.list[i].url = '/themes/firmware/'+res.data.list[i].url;
				}
    			if(_d==''){
      				_d = new Vue({
      					el : '#data',
      					data : {
      						datas : res.data
      					}
      				})
      			}else{
      				_d.datas = res.data
      			}
    		}
    	})
    }
    function _add(){
		if(max==p){
			layer.alert('当前已是最后一页！');
		}else{
			p++;
			_getData();
		}
	}
	function _sub(){
		if(p==1){
			layer.alert('已经是起始页！');
		}else{
			p--;
			_getData();
		}
	}
    function save(){
    	var name = $('#name').val();
    	var versionNumber = $('#versionNumber').val();
    	var params = 'url='+filePath+'&name='+name+'&versionNumber='+versionNumber;
    	if(name==''||name==null){
    		layer.alert('固件名称未填写！');
    	}else if(filePath==''){
    		layer.alert('固件未上传！');
    	}else{
    		$.ajax({
        		url:'/d/gnssrtkfirmware/save',
        		type:'post',
        		data:params,
        		dataType:'json',
        		success:function(res){
        			if('200'==res.code){
        				layer.alert('上传成功！',function(){
        					location.reload();
        				})
        			}else{
        				layer.alert(res.msg);
        			}
        		}
        	})
    	}
    }
</script>
</body>
</html>