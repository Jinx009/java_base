    <#include "gnss_header.html">
    <div class="page-content-wrapper">
        <div class="page-content">
            <div class="page-bar">
                <ul class="page-breadcrumb">
                    <li>
                        <i class="fa fa-home"></i>
                        <a href="#">控制管理</a>
                        <i class="fa fa-angle-right"></i>
                    </li>
                </ul>
            </div>
            <div class="row" style="margin-top: 15px;">
                <div class="col-md-12 col-sm-12">
                    <div class="portlet light bordered">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="icon-share font-blue-steel"></i>
                                <span class="caption-subject font-blue-steel ">设备管理</span>
                            </div>
                        </div>
                        <div class="portlet-body">
                        <div class="row">
								<form class="form-horizontal" role="form">
									<div class="form-body" >
										<div class="form-group" style="margin-top: 15px;">
											<div class="col-md-3" style="padding-left: 30px;">
												<input type="text" class="form-control" placeholder="输入MAC号码" id="mac" />
											</div>
											<div class="col-md-2">
												<button type="button" class="btn btn-success" onclick="_getData()">查询</button>
											</div>
										</div>
									</div>
								</form>
							 </div>
                            <div class="slimScrollDiv"
                                 style="position: relative;width: auto;"  id="data">
                            <div class="table-scrollable">
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                    <tr>
                                        <th scope="col">id</th>
                                        <th scope="col">命令</th>
                                        <th scope="col">全文</th>
                                        <th scope="col">状态</th>
                                        <th scope="col">mac</th>
                                        <th scope="col">回复状态</th>
                                         <th scope="col">回复全文</th>
                                        <th scope="col">创建时间</th>
                                        <th scope="col">操作</th>
                                    </tr>
                                    </thead>
                                    <tbody>
											<tr v-for="item in datas.list" >
												<td v-text="item.id" ></td>
												<td v-text="item.cmdName" ></td>
												<td v-text="item.content" style="max-width: 200px;overflow: hidden;padding-right: 10px;text-overflow: ellipsis;white-space: nowrap;"></td>
												<td>
													<font v-if="0===item.status" v-text="'新建'" ></font>
													<font v-if="1===item.status" v-text="'已回复'" ></font>
													<font v-if="item.status===2" v-text="'强制完成'" ></font>
												</td>
												<td v-text="item.mac" ></td>
												<td v-text="item.result" ></td>
												<td v-text="item.resultStr" style="max-width: 200px;overflow: hidden;padding-right: 10px;text-overflow: ellipsis;white-space: nowrap;"></td>
												<td v-text="item.createTime" ></td>
												<td>
													<a  v-if="0===item.status" class="edit" v-bind:id="item.id" onclick="_edit(this)" v-text="'强制完成'" > </a>
												</td>
											</tr>
								 	</tbody>
                                </table>
                            </div>
                            <div class="row">
                                <div class="col-md-9 col-sm-12"></div>
                                <div class="col-md-3 col-sm-12">
                                   <div class="dataTables_paginate paging_simple_numbers"
                                         id="sample_editable_1_paginate">
                                        <ul class="pagination">
                                            <li class="paginate_button previous "
                                                aria-controls="sample_editable_1" tabindex="0"
                                                id="sample_editable_1_previous">
                                               <a href="#" onclick="_sub()">
                                                    <i class="fa fa-angle-left"></i>
                                                </a>
                                            </li>
                                            <li class="paginate_button active" aria-controls="sample_editable_1"
                                                tabindex="0">
                                                 <a href="#" v-text="'当前第'+datas.page.currentPage+'页;共'+datas.page.pages+'页'" ></a>
                                            </li>
                                            <li class="paginate_button next "
                                                aria-controls="sample_editable_1" tabindex="0"
                                                id="sample_editable_1_next">
                                                 <a href="#" onclick="_add()">
                                                    <i class="fa fa-angle-right"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
  <#include "gnss_footer.html">
  <script>
$(function(){
	_setClass();
	_getData();
	_getMac();
})
function _edit(_e){
	var id = $(_e).attr('id');
	$.ajax({
		url:'/d/gnssrtkcontrol/update?id='+id,
		type:'post',
		dataType:'json',
		success:function(res){
			if(res.code=='200'){
				layer.alert('操作成功！',function(){
					location.reload();
				})
			}else{
				layer.alert(res.msg);
			}
		}
	})
}
var mac = '';
var p = 1;
var max = 1;
var _d = '';
function _getMac(){
	mac = getUrlParam('mac');
	if(mac==''||mac==null){
		mac = '';
	}
	$('#mac').val(mac);
}
function _getData(){
	if(mac!=$('#mac').val()){
		p = 1;max = 1;
		mac = $('#mac').val();
	}
	$.ajax({
		url:'/d/gnssrtkcontrol/list?mac='+mac+'&p='+p,
		type:'get',
		dataType:'json',
		success:function(res){
			max = res.data.page.pages;
			for(var i in res.data.list){
				res.data.list[i].createTime = toDateTime(parseInt(res.data.list[i].createTime));
			}
			if(_d==''){
  				_d = new Vue({
  					el : '#data',
  					data : {
  						datas : res.data
  					}
  				})
  			}else{
  				_d.datas = res.data
  			}
		}
	})
}
function _add(){
	if(max==p){
		layer.alert('当前已是最后一页！');
	}else{
		p++;
		_getData();
	}
}
function _sub(){
	if(p==1){
		layer.alert('已经是起始页！');
	}else{
		p--;
		_getData();
	}
}
</script>
  </body>
</html>