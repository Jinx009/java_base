package utils.ip;


import java.sql.SQLException;
import java.text.ParseException;

import javax.servlet.http.HttpServletRequest;

import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;

import utils.SichuanSqlUtils;

public class IPUtil {

	public static String getRemortIP(HttpServletRequest request) {
		String ip = request.getHeader("x-forwarded-for");
		if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
			ip = request.getHeader("Proxy-Client-IP");
		}
		if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
			ip = request.getHeader("WL-Proxy-Client-IP");
		}
		if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
			ip = request.getRemoteAddr();
		}
		if(ip != null && ip.length() > 0){
			String[] ipArray = ip.split(",");
			if (ipArray != null && ipArray.length > 1) {
				return ipArray[0];
			}
			return ip;
		}
		
		return "";
	}
	
	
	public static void main(String[] args) throws SQLException, ParseException {
		String json = "[\r\n" + 
				"{\"a\":\"511425010038\",\"b\":\"眉山市汉阳镇新路村3组易家湾滑坡\",\"wd\":\"29.4324\",\"jd\":\"103.4716\",\"c\":\"919060000004A\",\"\":\"000919060000004A\",\"\":\"2019/8/23\",\"d\":\"511425010038QX01\"},\r\n" + 
				"{\"a\":\"511425010038\",\"b\":\"眉山市汉阳镇新路村6组易家湾滑坡\",\"wd\":\"29.4324\",\"jd\":\"103.4716\",\"c\":\"9190600000051\",\"\":\"0009190600000051\",\"\":\"2019/8/23\",\"d\":\"511425010038QX02\"},\r\n" + 
				"{\"a\":\"511425010038\",\"b\":\"眉山市汉阳镇新路村5组易家湾滑坡\",\"wd\":\"29.4332\",\"jd\":\"103.4716\",\"c\":\"919060000004F\",\"\":\"000919060000004F\",\"\":\"2019/8/23\",\"d\":\"511425010038QX03\"},\r\n" + 
				"{\"a\":\"511425010038\",\"b\":\"眉山市汉阳镇新路村7组易家湾滑坡\",\"wd\":\"29.3430\",\"jd\":\"103.4717\",\"c\":\"9190600000052\",\"\":\"0009190600000052\",\"\":\"2019/8/23\",\"d\":\"511425010038QX04\"},\r\n" + 
				"{\"a\":\"511425010038\",\"b\":\"眉山市汉阳镇新路村4组易家湾滑坡\",\"wd\":\"29.4330\",\"jd\":\"103.4716\",\"c\":\"919060000004C\",\"\":\"000919060000004C\",\"\":\"2019/8/23\",\"d\":\"511425010038QX05\"},\r\n" + 
				"{\"a\":\"511425010038\",\"b\":\"眉山市汉阳镇新路村2组易家湾滑坡\",\"wd\":\"29.4330\",\"jd\":\"103.4716\",\"c\":\"9190600000049\",\"\":\"0009190600000049\",\"\":\"2019/8/23\",\"d\":\"511425010038QX06\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3707\",\"jd\":\"104.3601\",\"c\":\"919060000003D\",\"\":\"000919060000003D\",\"\":\"2019/8/22\",\"d\":\"511024010749QX01\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3707\",\"jd\":\"104.3601\",\"c\":\"919060000003C\",\"\":\"000919060000003C\",\"\":\"2019/8/22\",\"d\":\"511024010749QX02\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3706\",\"jd\":\"104.3601\",\"c\":\"9190600000037\",\"\":\"0009190600000037\",\"\":\"2019/8/22\",\"d\":\"511024010749QX03\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3706\",\"jd\":\"104.3602\",\"c\":\"9190600000035\",\"\":\"0009190600000035\",\"\":\"2019/8/22\",\"d\":\"511024010749QX04\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3705\",\"jd\":\"104.3606\",\"c\":\"919060000004E\",\"\":\"000919060000004E\",\"\":\"2019/8/22\",\"d\":\"511024010749QX05\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3704\",\"jd\":\"104.3607\",\"c\":\"9190600000047\",\"\":\"0009190600000047\",\"\":\"2019/8/22\",\"d\":\"511024010749QX06\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3705\",\"jd\":\"104.3608\",\"c\":\"919060000003A\",\"\":\"000919060000003A\",\"\":\"2019/8/22\",\"d\":\"511024010749QX07\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3705\",\"jd\":\"104.3608\",\"c\":\"9190600000043\",\"\":\"0009190600000043\",\"\":\"2019/8/22\",\"d\":\"511024010749QX08\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3706\",\"jd\":\"104.3609\",\"c\":\"9190600000055\",\"\":\"0009190600000055\",\"\":\"2019/8/23\",\"d\":\"511024010749QX09\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3707\",\"jd\":\"104.3610\",\"c\":\"9190600000054\",\"\":\"0009190600000054\",\"\":\"2019/8/23\",\"d\":\"511024010749QX10\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3708\",\"jd\":\"104.3609\",\"c\":\"9190600000041\",\"\":\"0009190600000041\",\"\":\"2019/8/23\",\"d\":\"511024010749QX11\"},\r\n" + 
				"{\"a\":\"511024010749\",\"b\":\"内江市威远县新场镇蔡家村石板屋基滑坡\",\"wd\":\"29.3706\",\"jd\":\"104.3603\",\"c\":\"9190600000050\",\"\":\"0009190600000050\",\"\":\"2019/8/23\",\"d\":\"511024010749QX12\"},\r\n" + 
				"{\"a\":\"511823010309\",\"b\":\"雅安市汉源县宜东镇林政村5组 红岩子滑坡\",\"wd\":\"29.1910\",\"jd\":\"102.4337\",\"c\":\"919060000003B\",\"\":\"000919060000003B\",\"\":\"2019/8/21\",\"d\":\"511823010309QX01\"},\r\n" + 
				"{\"a\":\"511823010309\",\"b\":\"雅安市汉源县宜东镇林政村8组 红岩子滑坡\",\"wd\":\"29.1756\",\"jd\":\"102.4412\",\"c\":\"9190600000064\",\"\":\"0009190600000064\",\"\":\"2019/8/21\",\"d\":\"511823010309QX02\"},\r\n" + 
				"{\"a\":\"511823010309\",\"b\":\"雅安市汉源县宜东镇林政村4组 红岩子滑坡\",\"wd\":\"29.1756\",\"jd\":\"102.4412\",\"c\":\"9190600000038\",\"\":\"0009190600000038\",\"\":\"2019/8/21\",\"d\":\"511823010309QX03\"},\r\n" + 
				"{\"a\":\"511823010309\",\"b\":\"雅安市汉源县宜东镇林政村7组 红岩子滑坡\",\"wd\":\"29.1755\",\"jd\":\"102.4411\",\"c\":\"9190600000046\",\"\":\"0009190600000046\",\"\":\"2019/8/21\",\"d\":\"511823010309QX04\"},\r\n" + 
				"{\"a\":\"511823010309\",\"b\":\"雅安市汉源县宜东镇林政村9组 红岩子滑坡\",\"wd\":\"29.1756\",\"jd\":\"102.4412\",\"c\":\"9190600000057\",\"\":\"0009190600000057\",\"\":\"2019/8/21\",\"d\":\"511823010309QX05\"},\r\n" + 
				"{\"a\":\"511823010309\",\"b\":\"雅安市汉源县宜东镇林政村6组 红岩子滑坡\",\"wd\":\"29.1756\",\"jd\":\"102.4413\",\"c\":\"919060000003E\",\"\":\"000919060000003E\",\"\":\"2019/8/21\",\"d\":\"511823010309QX06\"},\r\n" + 
				"{\"a\":\"511802010214\",\"b\":\"雅安市雨城区北郊镇峡口村1、2组\",\"wd\":\"30.0411\",\"jd\":\"103.0059\",\"c\":\"919060000003F\",\"\":\"000919060000003F\",\"\":\"2019/8/20\",\"d\":\"511802010214QX01\"},\r\n" + 
				"{\"a\":\"511802010214\",\"b\":\"雅安市雨城区北郊镇峡口村1、2组\",\"wd\":\"30.0412\",\"jd\":\"103.0100\",\"c\":\"9190600000040\",\"\":\"0009190600000040\",\"\":\"2019/8/20\",\"d\":\"511802010214QX02\"},\r\n" + 
				"{\"a\":\"511802010214\",\"b\":\"雅安市雨城区北郊镇峡口村1、2组\",\"wd\":\"30.0413\",\"jd\":\"103.0058\",\"c\":\"9190600000058\",\"\":\"0009190600000058\",\"\":\"2019/8/20\",\"d\":\"511802010214QX03\"},\r\n" + 
				"{\"a\":\"511802010214\",\"b\":\"雅安市雨城区北郊镇峡口村1、2组\",\"wd\":\"30.0416\",\"jd\":\"103.0056\",\"c\":\"9190600000059\",\"\":\"0009190600000059\",\"\":\"2019/8/20\",\"d\":\"511802010214QX04\"},\r\n" + 
				"{\"a\":\"511524010056\",\"b\":\"长宁县双河镇荷叶村龙川坝滑坡\",\"wd\":\"28.2309\",\"jd\":\"104.5256\",\"c\":\"190600000003\",\"\":\"\",\"\":\"\",\"d\":\"511524010056QX01\"},\r\n" + 
				"{\"a\":\"511524010056\",\"b\":\"长宁县双河镇荷叶村龙川坝滑坡\",\"wd\":\"28.2309\",\"jd\":\"104.5257\",\"c\":\"190600000004\",\"\":\"\",\"\":\"\",\"d\":\"511524010056QX02\"},\r\n" + 
				"{\"a\":\"511524010101\",\"b\":\"长宁县双河镇杨柳村7组大田包滑坡\",\"wd\":\"28.2252\",\"jd\":\"104.4955\",\"c\":\"190600000036\",\"\":\"\",\"\":\"\",\"d\":\"511524010101QX01\"},\r\n" + 
				"{\"a\":\"511524010101\",\"b\":\"长宁县双河镇杨柳村7组大田包滑坡\",\"wd\":\"28.2252\",\"jd\":\"104.4955\",\"c\":\"190600000039\",\"\":\"\",\"\":\"\",\"d\":\"511524010101QX02\"},\r\n" + 
				"{\"a\":\"511526020002\",\"b\":\"珙县巡场镇德窝村碳3社4社小岩子崩塌\",\"wd\":\"28.2445\",\"jd\":\"104.4145\",\"c\":\"190329000007\",\"\":\"\",\"\":\"\",\"d\":\"511526020002QX01\"},\r\n" + 
				"{\"a\":\"511526020002\",\"b\":\"珙县巡场镇德窝村碳3社4社小岩子崩塌\",\"wd\":\"28.2444\",\"jd\":\"104.4146\",\"c\":\"190329000016\",\"\":\"\",\"\":\"\",\"d\":\"511526020002QX02\"},\r\n" + 
				"{\"a\":\"511526010026\",\"b\":\"珙县巡场镇德窝村5社碳厂碥滑坡\",\"wd\":\"28.2459\",\"jd\":\"104.4124\",\"c\":\"190600000042\",\"\":\"\",\"\":\"\",\"d\":\"511526010026QX01\"},\r\n" + 
				"\r\n" + 
				"]";
		SichuanSqlUtils basicApp = new SichuanSqlUtils();
        basicApp.loadJdbcDriver();
        basicApp.connect();
		JSONArray arr = JSONObject.parseArray(json);
		for(int i = 1 ;i<arr.size();i++) {
			JSONObject o = arr.getJSONObject(i);
//			basicApp.insertJiancedian("511425010038QX01","511425010038","919060000004A","眉山市汉阳镇新路村3组易家湾滑坡",103.4716,29.4324);
			System.out.println(o.getString("d")+"--"+o.getString("a")+"--"+o.getString("c")+"--"+o.getString("b")+"--"+o.getDouble("jd")+"--"+o.getDouble("wd"));
			basicApp.insertJiancedian(o.getString("d"),o.getString("a"),o.getString("c"),o.getString("b"),o.getDouble("jd"),o.getDouble("wd"));
		}
		basicApp.disConnect();
	}
}
